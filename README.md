# Лекция 2

## 1. Инициализация проекта

`$ yarn init -y`

## 2. Установка необходимых зависимостей

Установим:

- webpack - сборщик
- webpack-cli - консольный интерфейс к webpack
- webpack-dev-server - инструмент для запуска проекта на локальном сервере
- html-webpack-plugin - плагин для webpack для генерации html-страниц

`$ yarn add -D webpack webpack-cli webpack-dev-server html-webpack-plugin`

В результате выполнения этой команды произойдет следующее:

- в файле `package.json` в секции `devDependencies` появятся установленные нами пакеты
- в проекте появится папка `node_modules`, в которой будут лежать установленные пакеты и их зависимости, загруженные из `registry.npmjs.org`
- в проекте появится файл `yarn.lock`, в котором перечислены установленные пакеты и их конкретные версии (нужно для того, чтобы гарантировать, чтобы у всех разработчиков и в CI всегда устанавливались ожидаемые версии)
- загруженные из `registry.npmjs.org` пакеты попадут в локальный кэш `yarn`. последующие установки будут происходить быстрее

Папка `node_modules` не должна храниться в git, поэтому создадим файл `.gitignore`, в котором укажем, что папку нужно игнорировать:

`.gitignore`:

```
node_modules
```

## 3. Базовая настройка webpack и первые файлы в проекте

Дефолтная конфигурация `webpack` вполне подойдет для демонстрационных целей, поэтому наш конфигурационный файл будет крайне минималистичным. Нам нужно всего лишь подключить `html-webpack-plugin` к `webpack`. Для этого создайте файл `webpack.config.js` в корне проекта и разместите в нем следующее:

```js
const HtmlWebpackPlugin = require("html-webpack-plugin");

module.exports = {
  plugins: [
    new HtmlWebpackPlugin({
      template: "./src/index.html"
    })
  ]
};
```

В качестве точки входа дефолтная конфигурация webpack ожидает файл `src/index.js`, поэтому создадим его (файл может быть пустым):

```
$ mkdir src && touch src/index.js
```

Кроме того, создадим шаблон html-страницы `src/index.html` и разместим в нем следующее:

```html
<!DOCTYPE html>
<html>
  <head>
    <title>Sample project</title>
  </head>
  <body>
    <h1>Hello, world!</h1>
  </body>
</html>
```

Остается только запустить наш проект следующей командой:

`$ yarn webpack-dev-server`

Произойдет (кратко), следующее:

- `webpack` соберет наше приложение (на данный момент состоящее из одного файла - `index.js`) в т. н. "бандл" и присвоит ему имя `main.js` (имя задано в дефолтной конфигурации). в терминологии `webpack` получившийся файл называется `asset`
- в `main.js` `webpack` заинжектит свой клиентский модуль (об этом далее)
- `html-webpack-plugin` считает шаблон `src/index.html`, заинжектит в него тег `script`, указывающий на `main.js` и присвоит получившемся файлу имя `index.html`
- `webpack-dev-server` запустит локальный веб-сервер, который будет раздавать получившиеся ассеты
- при изменении содержимого любого исходного файла `webpack-dev-server` автоматически запустит пересборку, а клиентский модуль `webpack` обновит страницу в браузере.

## 4. Подключим к проекту файл и обработаем его с помощью webpack (webpack loaders)

Установим `file-loader`:

`$ yarn add -D file-loader`

Добавим его к лоадерам и обозначим, что с его помощью хотим обрабатывать png-файлы:

`webpack.config.js`:

```diff
+  module: {
+    rules: [
+      {
+        test: /\.png$/,
+        use: "file-loader"
+      }
+    ]
+  },
+
```

В `index.html` добавим `<img />` без `src`. `src` назначим в JS-коде.

## 5. Напишем приложение-счетчик. Пока без redux.

В `index.html` добавим `<h2 />` для отображения значения счетчика и две кнопки для увеличения и уменьшения счетчика.

В `index.js` добавим логику.

## 6. Отрефакторим приложение счетчик

Разобьем логику на 2 фазы: обновление состояния счетчика и отрисовка.

## 7. Переделаем наше приложение на redux

### 7.1. Установим redux

`$ yarn add -D redux`

### 7.2. Напишем простейший reducer

### 7.3. Создадим store, в котором будет храниться текущее состояние приложения

### 7.4. Интегрируемся со store

### 7.5. Отрефакторим приложение. Удалим deprecated-код

### 7.6. Отрефакторим приложение. Используем action creators

### 8. Асинхронность в redux

### 8.1. "Наивный" подход

### 8.2. Middleware

### 8.3. redux-thunk
